FROM python:3.9.25-alpine3.22 AS build
WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt


FROM python:3.9.25-alpine3.22 AS prod

WORKDIR /app
# Create a non-root user appuser
RUN adduser -S appuser
USER appuser



# Copy installed dependencies from build stage
COPY --from=build /usr/local/lib/python3.9 /usr/local/lib/python3.9
COPY --from=build /usr/local/bin /usr/local/bin
COPY . .


EXPOSE 5000
CMD [ "python", "hello.py" ]
